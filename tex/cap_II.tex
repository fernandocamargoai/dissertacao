\chapter{Sistemas Hidrotérmicos de Geração}
\label{cap:sistemasHidrotermicos}

Em um sistema hidrotérmico de geração, como o encontrado no cenário Brasileiro, existem dois meios majoritários de geração de energia elétrica: através de usinas hidrelétricas, as quais utilizam a energia de quedas hidráulicas, e usinas termelétricas, as quais fazem queima de combustíveis fósseis ou fissão nuclear. A energia elétrica gerada através desses meios é transmitida para os mercados consumidores através de linhas de transmissão e distribuição.

Os custos envolvidos nessa geração de energia dependem da fonte utilizada. No caso da energia gerada através de usinas hidrelétricas, existe apenas o custo de manutenção e operação das máquinas, o qual não depende da quantidade de energia gerada. Portanto, essas apresentam custo fixo. Enquanto isso, ao produzir energia através de usinas termelétricas, o custo de geração depende do preço e quantidade dos combustíveis utilizados. Essa quantidade varia de acordo com a quantidade de energia gerada, caracterizando um custo variável.

Devido ao alto custo de combustíveis utilizados na geração elétrica, dá-se preferência à geração através de usinas hidrelétricas, que apresentam custos fixos e inferiores. Entretanto, essas não são capazes de gerar 100\% da energia necessária o tempo todo, visto que têm produtividade que varia de acordo com fenômenos naturais. Então, a estratégia utilizada é de se gerar energia primariamente através das usinas hidrelétricas e se complementar com as usinas termelétricas. A seguir, detalhamos o funcionamento de ambos tipos de usinas.

\section{Usinas Hidrelétricas}

O processo de geração de energia hidrelétrica baseia-se na transformação de energia potencial hidráulica, gerada pela diferença de altura, em energia elétrica. O processo se inicia com o armazenamento de água dos rios em reservatórios ou lagos, através da construção de obras de represamento. A principal função da represa é criar a diferença de altura, provocando o acúmulo de energia hidráulica. A água do reservatório é conduzida sob pressão através de condutos forçados até o conjunto de turbinas da usina, denominado casa de máquinas. Na casa de máquinas, a água é utilizada para impulsionar as pás (ou lâminas) das turbinas. A energia cinética e a energia de pressão dinâmica desenvolvida no percurso da água, através das tubulações, são convertidas em energia cinética de rotação. As turbinas estão ligadas a geradores que, postos em movimento contínuo, convertem a energia cinética em energia elétrica. Depois de passar pelas turbinas, a água retorna ao rio através de canais ou condutos, pelo chamado canal de fuga da usina. \cite{silva2014}

Além disso, é possível a liberação da água sem que essa passe pelas turbinas. Isso se dá através do vertedouro. O objetivo é controlar o nível do reservatório quando há mais água do que a usina consegue utilizar na geração de energia. O problema disso é que a água que passa pelo vertedouro pode ser considerada energia desperdiçada, já que a fonte de energia da usina é a água existente em seu reservatório.

Para que a energia gerada possa ser calculada, utiliza-se de um modelo matemática da usina. Esse modelo é uma função de geração que relaciona variáveis mensuráveis à energia gerada. Como entrada, esse modelo requer as seguintes variáveis: volume de água armazenado no reservatório, vazão turbinada e vazão vertida. Através delas,  é possível calcular a quantidade de energia gerada, como sugere a Figura \ref{fig:modeloHidreletrica}.

\begin{figure}[h]
  \centering
  \caption{Variáveis de entrada e saída utilizadas no Modelo geral de uma Usina Hidroelétrica}
  \includegraphics[width=\textwidth]{./fig/Modelo-Hidreletrica.pdf}
  \label{fig:modeloHidreletrica}
\end{figure}

Naturalmente, esse modelo matemático depende de outras variáveis além das variáveis de entrada. Portanto, estudaremos a seguir os principais componentes de uma usina hidrelétrica, como mostrado na Figura \ref{fig:componentesUsinasHidreletricas}.

\begin{figure}[h]
  \centering
  \caption{Principais componentes de uma Usina Hidrelétrica \cite{silva2014}}
  \includegraphics[width=\textwidth]{./fig/Componentes-usinas-hidreletricas.jpg}
  \label{fig:componentesUsinasHidreletricas}
\end{figure}

\begin{description}
 \item[$v$] volume do reservatório [$hm^{3}$]
 \item[$v^{max}$] volume máximo operativo do reservatório [$hm^{3}$]
 \item[$v^{min}$] volume mínimo operativo do reservatório [$hm^{3}$]
 \item[$v_{útil}$] volume útil do reservatório ($v^{max} - v^{min}$) [$hm^{3}$]
 \item[$q$] vazão turbinada pela casa de máquinas (engolimento) [$m^{3}/s$]
 \item[$spl$] vazão descarregada pelo vertedouro (vertimento) [$m^{3}/s$]
 \item[$u$] vazão descarregada pela usina (defluência) ($q + spl$) [$m^{3}/s$]
 \item[$h_{mon}(v)$] cota de montante do reservatório (função do volume) [$m$]
 \item[$h_{jus}(u)$] cota de jusante do reservatório (função da defluência) [$m$]
 \item[$h(v, u)$] altura de queda líquida ($h_{mon}(v) - h_{jus}(u)$) [$m$]
\end{description}

Vale notar que a variável $q$, a qual representa a vazão turbinada, é limitada pelo engolimento máximo da usina $q^{max}$, que é a vazão turbinada capaz de produzir a potência máxima da usina para uma dada altura de queda.

\subsection{Reservatórios}

O reservatório de uma usina hidrelétrica é responsável por armazenar a água que será utilizada na geração elétrica. Eles são classificados em duas categorias: de compensação e de acumulação. Enquanto os reservatórios de compensação têm volume o suficiente apenas para regularização de cargas semanais ou mensais, os de acumulação são capazes de regularizar vazões de alguns meses a alguns anos, tudo isso dependendo de seu volume. Por regularizar, entende-se a capacidade de atenuar a variação da disponibilidade de água, tornando possível a utilizando de água proveniente de um período de chuvas em um período de estiagem. Vale notar que em horizontes de planejamento de médio e longo prazo, a capacidade de regularização de usinas fio d'água, aquelas com reservatório de compensação, são desprezadas.

Em um mesmo rio, é comum a construção de uma cascata de usinas hidrelétricas. Dessa forma, a vazão descarregada da usina anterior, conhecida como montante, irá para o reservatório da usinas posterior, conhecida como jusante. Essa vazão poderá passar novamente por regularização no reservatório da usina em jusante. A Figura \ref{fig:cascataUsinas} ilusta uma cascata de usinas localizadas no sistema sudeste. As usinas com reservatório de acumulação são representadas pelo símbolo triangular, enquanto as usinas com reservatório de compensação são representadas pelo símbolo circular.

\begin{figure}[h]
  \centering
  \caption{Cascata de usinas localizadas no sistema sudeste}
  \includegraphics[width=\textwidth]{./fig/Cascata-Usinas.pdf}
  \label{fig:cascataUsinas}
\end{figure}

O volume do reservatório de uma usina hidrelétrica é dividido em três faixas: volume morto, volume útil e volume de segurança. O volume morto de uma usina é aquele que não pode ser aproveitado para a geração de energia elétrica, devido às restrições da usina em questão. Ele serve de referência como volume mínimo ($v_{min}$) necessário para a entrada de água no sistema de adução e, assim, gerar energia. A próxima faixa é o volume útil, que é aquele armazenado entre o volume mínimo ($v_{min}$) e o máximo ($v_{max}$) operativos. Esse é o volume que pode ser aproveitado na geração de energia. Por último, o volume de segurança é aquele acima do volume máximo operativo ($v_{max}$) e abaixo do volume máximo de projeto do reservatório. Normalmente, esse se encontrará vazio.

Além de armazenar a água para uma posterior conversão em energia, o represamento de água pelas barragens também tem por objetivo criar uma diferença de nível entre o reservatório e o canal de fuga. Essa diferença é chamada altura de queda bruta, conforme a Equação \ref{eq:alturaQuedaBruta}, onde $h_{mon}(v)$, chamado de cota de montante, é o nível do reservatório e $h_{jus}(u)$, chamado de cota de jusante, é o nível do canal de fuga. Esses níveis são funções do volume e da defluência, respectivamente.

\begin{equation}\label{eq:alturaQuedaBruta}
 h(v,u) = h_{mon}(v) - h_{jus}(u)
\end{equation}

Porém, a Equação \ref{eq:alturaQuedaBruta} não está completa, pois há ainda a perda de carga hidráulica causada pelo atrito entre a água e o canal de adução ao longo do percurso do reservatório até as turbinas, como descrito por \cite{fortunato1990}. Essa perda é representada por $pc$, sendo usualmente adotada como um valor constante médio. Assim, a altura de queda líquida é dada pela Equação \ref{eq:alturaQuedaBruta2}.

\begin{equation}\label{eq:alturaQuedaBruta2}
 h(v,u) = h_{mon}(v) - h_{jus}(u) - pc
\end{equation}

\subsection{Conjuntos Turbina/Gerador}

Como visto na Figura \ref{fig:modeloHidreletrica}, a água armazenada no reservatório é transferida para a casa de máquinas através de condutos forçados, onde se encontram as unidades geradoras. Tais unidades são divididas em diferentes conjuntos, de acordo com suas características, sendo cada uma é composta por um conjunto turbina/gerador.

As unidades geradoras são responsáveis por transformar energia potencial em energia elétrica. Para entender seu funcionamento, deve-se entender esse processo de transformação e como ela afeta a produtividade de um conjunto turbina/gerador. Para começar, a variação de energia potencial pode ser expressa como na Equação \ref{eq:variacaoDeEnergiaPotencial}, onde $dm$ é uma variação incremental de massa de água armazenada no reservatório, $g$ é a aceleração da gravidade e $h$ é a altura de queda desse reservatório (diferença entre os níveis de montante e de jusante).

\begin{equation}\label{eq:variacaoDeEnergiaPotencial}
 de_{p} = dm.g.h
\end{equation}

Considerando o peso específico da água $pa$ ($1000 kg/m^{3}$) e tansformando o volume de água em vazão no tempo, podemos reescrever a Equação \ref{eq:variacaoDeEnergiaPotencial} conforme a Equação \ref{eq:variacaoDeEnergiaPotencial2}.

\begin{equation}\label{eq:variacaoDeEnergiaPotencial2}
 de_{p} = pa.q.dt.g.h
\end{equation}

A transformação de energia potencial em energia elétrica depende do rendimento $\eta$ do processo de conversão de energia pelo conjunto turbina/gerador. Essa transformação pode ser expressa pela Equação \ref{eq:transformacaoEnergiaPotencialEletrica}, em que $\eta$ varia em função da vazão turbinada e a altura de queda líquida.

\begin{equation}\label{eq:transformacaoEnergiaPotencialEletrica}
 e_{e} = \eta.e_{p}
\end{equation}

Porém, o planejamento da operação energética no sistema brasileiro considera um rendimento médio $\bar{\eta}$ \cite{fortunato1990}. Logo, a equação da geração de energia elétrica pode ser escrita como na Equação \ref{eq:geracaoEnergiaEletrica}.

\begin{equation}\label{eq:geracaoEnergiaEletrica}
 de_{e} = \bar{\eta}.pa.q.dt.g.h
\end{equation}

Transformando essa energia em potência ($p = \tfrac{de}{dt}$), temos a Equação \ref{eq:geracaoPotencia}.

\begin{equation}\label{eq:geracaoPotencia}
 p = \bar{\eta}.pa.q.g.h
\end{equation}

A altura de queda considerada é a altura de queda líquida do reservatório, ou seja, a altura de queda bruta menos as perdas de carga $pc$, como mostrado na Equação \ref{eq:alturaQuedaBruta2}. Assim, chegamos na Equação \ref{eq:geracaoPotencia2}.

\begin{equation}\label{eq:geracaoPotencia2}
 p = \bar{\eta}.pa.q.g.(h_{mon}(v) - h_{jus}(u) - pc)
\end{equation}

Englobando em uma constante $k$ o rendimento do conjunto turbina/gerador ($\bar{\eta}$), a aceleração da gravidade ($g$) e o peso específico da água ($pa$), pode-se escrever a função de geração hidráulica ($gh$) conforme a Equação \ref{eq:geracaoHidraulica}.

\begin{equation}\label{eq:geracaoHidraulica}
 gh = k.(h_{mon}(v) - h_{jus}(u) - pc).q
\end{equation}

Assim, pode-se observar que a geração hidrelétrica é uma função do volume armazenado e das vazões turbinada e vertida. A constante $k=\bar{\eta}.pa.g$ é comumente denominada produtibilidade específica.

Segundo \cite{fortunato1990}, o rendimento médio calculado para grandes unidades geradoras situa-se no intervalo:

\begin{displaymath}
 0,88 < \bar{\eta} \leq 0,94
\end{displaymath}

Assim, a produtibilidade específica assume valores entre:

\begin{displaymath}
 0,00863 < k \leq 0,0092
\end{displaymath}

O engolimento máximo da usina normalmente é calculado considerando-se que a usina possa possuir vários conjuntos de máquinas. Cada conjunto é formado por máquinas com a mesma potência e engolimento máximo. Para a usina como um todo, o engolimento máximo total será a soma dos engolimentos de cada conjunto, como mostra a Equação \ref{eq:engolimentoMaximoTotal}, onde $NCM$ é o número de conjuntos de máquinas da usina, $NMC$ é o número de máquinas do conjunto $n$ e $\bar{q}_{nm}$ é o engolimento máximo da máquina $m$ do conjunto $n$.

\begin{equation}\label{eq:engolimentoMaximoTotal}
 q_{max} = \sum_{n=1}^{NCM} \sum_{m=1}^{NMC} \bar{q}_{nm}
\end{equation}

\section{Usinas Termelétricas}

Em usinas termelétricas, a geração de energia elétrica é realizada através de transformação de energia térmica em energia mecânica, a qual movimenta uma turbina acoplada a um gerador para transformá-la em energia elétrica. Elas são dividias em duas categorias quanto ao combustível utilizado: convencionais, cujos combustíveis são fósseis, como carvão, óleo, gás natural e biomassa; e usinas nucleares, que utilizam combustíveis físseis, como urânio natural e enriquecido. E também são divididas em três categorias quanto a forma com que o combustível é queimado: usinas a vapor, a gás ou a combustão direta.

Nas usinas a vapor, o combustível é queimado para fornecer calor a uma caldeira com água armazenada. Ao ser aquecida, a água é transformada em vapor que, sob pressão, faz girar as pás da turbina. Assim, a energia cinética do vapor é transformado em energia elétrica. Em usinas com turbinas a gás, as pás das turbinas são movimentadas mediante a mistura gasosa de ar comprimido com o gás resultante da queima do combustível. Já em usinas de combustão direta, utiliza-se motores a pistão alimentados por um combustível fóssil, sendo geralmente utilizado o óleo diesel. Esses motores são acoplados a geradores elétricos, que transformam a energia mecâmica em elétrica.

A geração de energia em uma usina termelétrica está associada à aquisição do combustível primário, existindo uma relação produção por custo para cada unidade geradora. Somado aos custos dos combustíveis, estão os custos operacionais, como mão-de-obra e manutenção de equipamentos. Contudo, como não há métodos diretos para expressar tais custos em função da saída, geralmente esses custos operacionais são considerados como custos fixos. O custo total costuma ser modelado como uma função convexa e crescente, aproximada por polinômios de segundo ou terceiro graus \cite{elhawary1979}, com limites de geração mínima e máxima.

\section{Formulação do Problema de Planejamento da Operação Energética}

O planejamento da operação energética tem como objetivo minimizar o custo de geração de um sistema termelétrico, ao mesmo tempo que mantém os reservatórios das usinas hidrelétricas em alta. Ou seja, temos aqui dois objetivos distintos: minimizar o custo, o qual tem sua porção variável na geração térmica complementar, e maximizar o volume final dos reservatórios. Para resolver esse problema, consideram-se conhecidas as vazões afluentes e a demanda e leva-se em conta as características individuais de cada usina hidrelétrica. As funções objetivos a serem otimizadas são descritas pelo vetor objetivo $\vec{F}$ mostrado na Equação \ref{eq:funcoesObjetivo}, onde $CT$ representa a soma dos custos de geração de energia por usinas térmicas durante todo o período de planejamento (Equação \ref{eq:funcaoObjetivoCustoTermico}) e $VF$ é associada ao nível dos reservatórios das hidrelétricas no último período de planejamento.

\begin{equation}\label{eq:funcoesObjetivo}
 \vec{F} = \{CT, VF\}
\end{equation}

O parque termelétrico é considerado como se toda a geração elétrica se concentrasse em uma única usina, isso se dá pela impossibilidade de se poder atribuir um custo preciso à operação da geração térmica sem considerar diversos outros fatores, como por exemplo, o preço atual dos combustíveis utilizados e o tipo de usina. Portanto, utiliza-se uma função polinomial para representar o custo da geração da energia elétrica, como exibido na Equação \ref{eq:custoTermico}.

\begin{equation}\label{eq:funcaoObjetivoCustoTermico}
 CT = min \sum_{t=1}^{T} f(gt_{t})
\end{equation}

\begin{equation}\label{eq:custoTermico}
 f(gt_{t}) = \alpha + \beta.gt_{t} + \gamma.gt_{t}^{2} 
\end{equation}

As funções objetivos estão sujeitas às seguintes restrições:

\begin{equation}\label{eq:balanceamentoDeCarga}
 gt_{t} + \sum_{i=1}^{N} gh_{it} - D_{t} - L_{t} = 0
\end{equation}

\begin{equation}\label{eq:limitesGeracaoTermica}
 gt^{min} \leq gt_{t} \leq gt^{max}
\end{equation}

\begin{equation}\label{eq:limitesGeracaoHidreletrica}
 gh_{i}^{min} \leq gh_{it} \leq gh_{i}^{max}
\end{equation}

\begin{equation}\label{eq:geracaoHidraulica}
 gh_{it} = k_{i}.[h_{mon}(v_{it}) - h_{jus}(q_{it} + spl_{i}) - pc].q_{it}
\end{equation}

\begin{equation}\label{eq:balanceamentoDinamicoDaAgua}
 v_{it} = v_{i,t-1} + y_{it} - q_{it} - spl_{it} + \sum_{m=1}^{\Phi_{i}} (q_{m,t} + spl_{m,t}), m \in \Phi_{i}
\end{equation}

\begin{equation}\label{eq:limitesArmazenamento}
 v_{i}^{min} \leq v_{it} \leq v_{i}^{max}
\end{equation}

\begin{equation}\label{eq:volumeInicial}
 v_{i0} = v_{i}^{ini}
\end{equation}

\begin{equation}\label{eq:volumeFinal}
 v_{iT} = v_{i}^{final}
\end{equation}

\begin{equation}\label{eq:limitesTurbinagem}
 q_{i}^{min} \leq q_{it} \leq q_{i}^{max}(h_{i}(t))
\end{equation}

onde: 

\begin{description}
 \item[$F$] custo térmico total durante o horizonte [\$]
 \item[$T$] número de estágios do horizonte de planejamento (intervalo de tempo) [meses]
 \item[$t$] índice do intervalo de tempo [mês]
 \item[$N$] número de usinas hidrelétricas do sistema
 \item[$i$] índice da usina hidrelétrica do sistema
 \item[$gt_{t}$] geração termelétrica durante o intervalo $t$ [$\overline{\rm MW}$\footnote{Um $\overline{\rm MW}$ é a energia correspondente a uma fonte de um $MW$ de potência em dado período. Neste caso, o período considerado é de um mês.}]
 \item[$f(gt_{t})$] função de custo de geração térmica no instante $t$ [\$]
 \item[$gh_{it}$] geração da usina hidrelétrica $i$ durante o período $t$ [$\overline{\rm MW}$]
 \item[$v_{it}$] volume do reservatório da usina hidrelétrica $i$ no final do intervalo $t$ [$hm^{3}$]
 \item[$q_{it}$] vazão turbinada pela usina hidrelétrica $i$ durante o intervalo $t$ [$m^{3}$]
 \item[$spl_{it}$] vazão vertida pela usina hidrelétrica $i$ durante o intervalo $t$ [$m^{3}$]
 \item[$k_{it}$] produtibilidade da usina hidrelétrica $i$
 \item[$h_{mon}(v_{it})$] função da cota do montante do reservatório da usina hidrelétrica $i$ no instante $t$ [$m$]
 \item[$h_{jus}(q_{it} + spl_{it})$] função da cota do jusante do reservatório da usina hidrelétrica $i$ no instante $t$ [$m$]
 \item[$pc$] perdas hidráulicas
 \item[$y_{it}$] vazão incremental afluente à usina hidrelétrica $i$ durante o intervalo $t$ [$m^{3}/s$]
 \item[$\Phi_{i}$] conjunto de usinas imediatamente a montante da usina $i$
 \item[$D_{t}$] mercado (demanda) a ser atendido durante o período $t$ [$\overline{\rm MW}$]
 \item[$L_{t}$] perdas na transmissão de energia no instante $t$ [$\overline{\rm MW}$]
 \item[$\alpha, \beta, \gamma$] coeficientes da função custo de geração térmica
 \item[$v_{i}^{min},v_{i}^{max}$] volume mínimo e máximo do reservatório da usina hidrelétrica $i$ [$hm^{3}$]
 \item[$v_{i}^{ini},v_{i}^{final}$] volume inicial e final do reservatório da usina hidrelétrica $i$ [$hm^{3}$]
 \item[$q_{i}^{min},q_{i}^{max}$] turbinagem mínima e máxima da usina hidrelétrica $i$ [$m^{3}$]
 \item[$gh_{i}^{min},gh_{i}^{max}$] capacidade mínima e máxima de geração hidráulica da usina hidrelétrica $i$ [$\overline{\rm MW}$]
 \item[$gt_{i}^{min},gt_{i}^{max}$] capacidade mínima e máxima de geração térmica [$\overline{\rm MW}$]
 \item[$h_{i}(t)$] altura de queda da usina hidrelétrica $i$ no instante $t$ [$m$]
\end{description}

Dentre as equações apresentadas, vale a pena destacar algumas equações para tornar a formulação mais clara. A equação \ref{eq:balanceamentoDeCarga}, que é conhecida como equação de balanceamento de carga e representa o balanço entre produção térmica ($gt$) e hidráulica ($gh$) para atender à demanda $D$, considerando as perdas de carga $L$ na transmissão. Já o balanceamento dinâmico de água, apresentado pela equação \ref{eq:balanceamentoDinamicoDaAgua}, garante o correto equilíbrio entre a água que entra e sai da usina. Ela indica que o volume do reservatório de uma usina num determinado instante $t$ é o volume que ela possuía no instante anterior, somado ao que recebeu de água (seja vazão incremental ou oriunda das usinas à montante), subtraído o que ela devolveu de água ao sistema (seja turbinada ou vertida). As demais equações descrevem os cálculos de geração térmica e hidrelétrica, além de especificar as restrições do sistema.

Vale observar que algumas características, que seriam importantes em um planejamento de curto prazo, puderam ser ignoradas aqui. Por exemplo, em uma discretizações horárias, deve-se levar em conta a diferença de tempo que a vazão de uma usina a montante leva para chegar ao reservatório da usina à jusante. Entretanto, com uma discretização mensal, isso pode ser ignorado.

