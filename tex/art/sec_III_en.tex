%\section{Sistemas Hidrotérmicos de Geração}
\section{Hydrothermal Systems of Generation}
\label{cap:sistemasHidrotermicos}

%O processo de geração de energia hidrelétrica baseia-se na transformação de energia potencial hidráulica, gerada pela diferença de altura, em energia elétrica. O processo se inicia com o armazenamento de água dos rios em reservatórios ou lagos, através da construção de obras de represamento. A principal função da represa é criar a diferença de altura, provocando o acúmulo de energia hidráulica. A água do reservatório é conduzida sob pressão através de condutos forçados até o conjunto de turbinas da usina, denominado casa de máquinas. Na casa de máquinas, a água é utilizada para impulsionar as pás (ou lâminas) das turbinas. A energia cinética e a energia de pressão dinâmica desenvolvida no percurso da água, através das tubulações, são convertidas em energia cinética de rotação. As turbinas estão ligadas a geradores que, postos em movimento contínuo, convertem a energia cinética em energia elétrica. Depois de passar pelas turbinas, a água retorna ao rio através de canais ou condutos, pelo chamado canal de fuga da usina. \cite{silva2014}

The process of hydroelectric energy generation is based on the transformation of hydraulic potential energy, generated by the difference of height, in electric energy. This process begins with the storage of water of rivers in reservoir or lakes through the construction of dikes. The main purpose of the dyke is to create the difference of height, producing the accumulation of hydraulic energy. The water of the reservoir is conducted under pressure through the forced conduits to the turbines, named house of machines. In this house of machines, the water is used to propel the blades of the turbines. The kinetic energy and the energy of dynamic pressure developed in the course of the water, through the pipes, are converted in kinetic energy of rotation. \cite{silva2014}

%Além disso, é possível a liberação da água sem que essa passe pelas turbinas. Isso se dá através do vertedouro. O objetivo é controlar o nível do reservatório quando há mais água do que a usina consegue utilizar na geração de energia. O problema disso é que a água que passa pelo vertedouro pode ser considerada energia desperdiçada, já que a fonte de energia da usina é a água existente em seu reservatório.

Besides that, it's possible to release the water without having to go through the turbines. It's done through the spillway. The goal is to control the level of reservoir when there's more water than the plant can use to generate energy. The problem is that the water which goes through the spillway can be considered wasted energy, since it can no longer be used.

%Para que a energia gerada possa ser calculada, utiliza-se de um modelo matemática da usina. Esse modelo é uma função de geração que relaciona variáveis mensuráveis à energia gerada. Para a criação desse modelo, deve-se entender os principais componentes de uma usina hidrelétrica, como mostrado na Figura \ref{fig:componentesUsinasHidreletricas}.

To calculate the generated energy, a mathematical model of the plant is used. This model is a function of generation that related measurable variables to the generated energy. To create this model, it's necessary to understand the main components of a hydroelectric plant, as shown in the Figure \ref{fig:componentesUsinasHidreletricas}.

\begin{figure}[!t]
  \centering
  \caption{Main components of a hydroelectric plant \cite{silva2014}}
  \includegraphics[width=2.5in]{./fig/Componentes-usinas-hidreletricas_en.jpg}
  \label{fig:componentesUsinasHidreletricas}
\end{figure}

\begin{description}[\IEEEsetlabelwidth{$h_{down}(u)$}]
 \item[$v$] volume of the reservoir [$hm^{3}$]
 \item[$v^{max}$] maximum operational volume of the reservoir [$hm^{3}$]
 \item[$v^{min}$] minimum operational volume of the reservoir [$hm^{3}$]
 \item[$v_{u}$] useful volume of the reservoir ($v^{max} - v^{min}$) [$hm^{3}$]
 \item[$q$] flow turbinated by the house of machines (swallowing) [$m^{3}/s$]
 \item[$spl$] flow unloaded through the spillway (spilling) [$m^{3}/s$]
 \item[$u$] flow unloaded by the plant (defluence) ($q + spl$) [$m^{3}/s$]
 \item[$h_{up}(v)$] upstream quote of the reservoir (function of volume) [$m$]
 \item[$h_{down}(u)$] downstream quote of the reservoir (function of defluence) [$m$]
 \item[$h(v, u)$] height of net fall ($h_{up}(v) - h_{down}(u)$) [$m$]
\end{description}

%Vale notar que a variável $q$, a qual representa a vazão turbinada, é limitada pelo engolimento máximo da usina $q^{max}$, que é a vazão turbinada capaz de produzir a potência máxima da usina para uma data altura de queda.

It's worth noting that the variable $q$, which represents the turbinated flow, is limited by the maximum swallowing of the plant $q^{max}$, that is the turbinated flow capable of producing the maximum potency of the plant for a given fall height.

%Em um mesmo rio, é comum a construção de uma cascata de usinas hidrelétricas. Dessa forma, a vazão descarregada da usina anterior, conhecida como montante, irá para o reservatório da usinas posterior, conhecida como jusante. Essa vazão poderá passar novamente por regularização no reservatório da usina em jusante.

On the same river, it's common to build a cascade of hydroelectric plants. This way, the unloaded flow from the previous plant, known as upstream, will go to the reservoir of the next plant, known as downstream. This flow can be regulated again by the reservoir of the downstream plant.

%\subsection{Formulação do Problema de Planejamento da Operação Energética}
\subsection{Formulation of the Problem of Energy Operation Planning}

%O planejamento da operação energética tem como objetivo minimizar o custo de geração de um sistema termelétrico, ao mesmo tempo que mantém os reservatórios das usinas hidrelétricas em alta. Ou seja, temos aqui dois objetivos distintos: minimizar o custo, o qual tem sua porção variável na geração térmica complementar, e maximizar o volume final dos reservatórios. Para resolver esse problema, consideram-se conhecidas as vazões afluentes e a demanda e leva-se em conta as características individuais de cada usina hidrelétrica. As funções objetivos a serem otimizadas são descritas pelo vetor objetivo $\vec{F}$ mostrado na Equação \ref{eq:funcoesObjetivo}, onde $CT$ representa a soma dos custos de geração de energia por usinas térmicas durante todo o período de planejamento (Equação \ref{eq:funcaoObjetivoCustoTermico}) e $VF$ é associada ao nível dos reservatórios das hidrelétricas no último período de planejamento.

The energy operation planning has the goal of minimizing the generation cost of a hydrothermal system, at the same time that keep the level of reservoirs high. It means that we have two distinct objectives: minimize the cost, which has its variable part in the complementary thermal generation, and maximize the final volume of storage. To solve this problem, we consider the affluences and the demand as known and take into consideration the individual characteristics of each hydroelectric plant. The objective functions to be otimized are described by the objective vector $\vec{F}$ shown in the Equation \ref{eq:funcoesObjetivo}, where $CT$ represents the sum of thermal generation costs during the whole period of planning (Equation \ref{eq:funcaoObjetivoCustoTermico}) and $VF$ is associated with the level of storage of the hydroelectric plants in the last period of planning.

\begin{equation}\label{eq:funcoesObjetivo}
 \vec{F} = \{CT, VF\}
\end{equation}

%O parque termelétrico é considerado como se toda a geração elétrica se concentrasse em uma única usina, isso se dá pela impossibilidade de se poder atribuir um custo preciso à operação da geração térmica sem considerar diversos outros fatores. Portanto, utiliza-se uma função polinomial para representar o custo da geração da energia elétrica, como exibido na Equação \ref{eq:custoTermico}.

As the source of thermal energy, we consider as if it is all provided by a single thermal plant. That's because it's impossible to assign the accurate cost of operation of the thermal generation without considering a lot of factors. Therefore, we'll use a polynomial function to represent its generation cost, as shown in the Equation \ref{eq:custoTermico}.

\begin{equation}\label{eq:funcaoObjetivoCustoTermico}
 CT = min \sum_{t=1}^{T} f(gt_{t})
\end{equation}

\begin{equation}\label{eq:custoTermico}
 f(gt_{t}) = \alpha + \beta.gt_{t} + \gamma.gt_{t}^{2} 
\end{equation}

%As funções objetivos estão sujeitas às seguintes restrições:
The objective functions are subjected to the following restrictions:

\begin{equation}\label{eq:balanceamentoDeCarga}
 gt_{t} + \sum_{i=1}^{N} gh_{it} - D_{t} - L_{t} = 0
\end{equation}

\begin{equation}\label{eq:limitesGeracaoTermica}
 gt^{min} \leq gt_{t} \leq gt^{max}
\end{equation}

\begin{equation}\label{eq:limitesGeracaoHidreletrica}
 gh_{i}^{min} \leq gh_{it} \leq gh_{i}^{max}
\end{equation}

\begin{equation}\label{eq:geracaoHidraulica}
 gh_{it} = k_{i}.[h_{up}(v_{it}) - h_{down}(q_{it} + spl_{i}) - pc].q_{it}
\end{equation}

\begin{equation}\label{eq:balanceamentoDinamicoDaAgua}
 v_{it} = v_{i,t-1} + y_{it} - q_{it} - spl_{it} + \sum_{m=1}^{\Phi_{i}} (q_{m,t} + spl_{m,t}), m \in \Phi_{i}
\end{equation}

\begin{equation}\label{eq:limitesArmazenamento}
 v_{i}^{min} \leq v_{it} \leq v_{i}^{max}
\end{equation}

\begin{equation}\label{eq:volumeInicial}
 v_{i0} = v_{i}^{ini}
\end{equation}

\begin{equation}\label{eq:volumeFinal}
 v_{iT} = v_{i}^{final}
\end{equation}

\begin{equation}\label{eq:limitesTurbinagem}
 q_{i}^{min} \leq q_{it} \leq q_{i}^{max}(h_{i}(t))
\end{equation}

onde: 

\begin{description}[\IEEEsetlabelwidth{$h_{down}(q_{it} + spl_{it})$}]
 \item[$F$] total thermal cost during the horizon [\$]
 \item[$T$] number of stages of the planning horizon (time interval) [months]
 \item[$t$] index of the time interval [month]
 \item[$N$] number of plants of the system
 \item[$i$] index of the plant of the system
 \item[$gt_{t}$] thermal generation during the interval $t$ [$\overline{\rm MW}$\footnote{One $\overline{\rm MW}$ is the energy equivalent of a source of one $MW$ of potency in a given interval. In this case, we considered one month.}]
 \item[$f(gt_{t})$] cost function of thermal generation in the interval $t$ [\$]
 \item[$gh_{it}$] generation of the plant $i$ during the interval $t$ [$\overline{\rm MW}$]
 \item[$v_{it}$] storage volume of the plant $i$ in the end of interval $t$ [$hm^{3}$]
 \item[$q_{it}$] turbinated flow by the plant $i$ during the interval $t$ [$m^{3}$]
 \item[$spl_{it}$] spilled flow by the plant $i$ during the interval $t$ [$m^{3}$]
 \item[$k_{it}$] producibility of plant $i$
 \item[$h_{up}(v_{it})$] function of the height of upstream of the plant $i$ at the end of the interval $t$ [$m$]
 \item[$h_{down}(q_{it} + spl_{it})$] function of the height of downstream of the plant $i$ at the end of the interval $t$ [$m$]
 \item[$pc$] hydraulic losses
 \item[$y_{it}$] incremental affluent flow of the plant $i$ during the interval $t$ [$m^{3}/s$]
 \item[$\Phi_{i}$] set of plants immediately downstream the plant $i$
 \item[$D_{t}$] demand to be attended during the interval $t$ [$\overline{\rm MW}$]
 \item[$L_{t}$] transmission losses of energy during the interval $t$ [$\overline{\rm MW}$]
 \item[$\alpha, \beta, \gamma$] coefficients of the thermal generation cost function
 \item[$v_{i}^{min},v_{i}^{max}$] minimum and maximum volume of the reservoir of the plant $i$ [$hm^{3}$]
 \item[$v_{i}^{ini},v_{i}^{final}$] initial and final volume of the reservoir of the plant $i$ [$hm^{3}$]
 \item[$q_{i}^{min},q_{i}^{max}$] minimum and maximum turbination of the plant $i$ [$m^{3}$]
 \item[$gh_{i}^{min},gh_{i}^{max}$] minimum and maximum capacity of hydraulic generation of the plant $i$ [$\overline{\rm MW}$]
 \item[$gt_{i}^{min},gt_{i}^{max}$] minimum and maximum capacity of thermal generation [$\overline{\rm MW}$]
 \item[$h_{i}(t)$] fall height of the plant $i$ at the end of the interval $t$ [$m$]
\end{description}
